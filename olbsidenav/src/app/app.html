<div class="global-banner">
  <div class="global-banner__content">
    <div class="banner-left">
      <button class="icon-btn" (click)="toggleMenuPlacement()" aria-label="Ansicht umschalten">
        <mat-icon>{{ showMenuInBanner() ? 'more_vert' : 'more_horiz' }}</mat-icon>
      </button>
      <div class="logo" aria-label="Logo">
        <img [src]="logoUrl" alt="Logo" />
      </div>
    </div>

    <div class="banner-center">
      <ng-container *ngIf="showMenuInBanner(); else emptyCenter">
        <div class="banner-menu">
          <ng-container *ngFor="let item of menu()">
            <ng-container *ngIf="!item.children?.length; else parentButton">
              <button class="banner-item" (click)="item.externalUrl ? openExternal(item) : navigateTo(item.route)">
                <mat-icon>{{ item.icon }}</mat-icon>
                <span>{{ item.label }}</span>
              </button>
            </ng-container>
            <ng-template #parentButton>
              <button class="banner-item" [matMenuTriggerFor]="menuRef">
                <mat-icon>{{ item.icon }}</mat-icon>
                <span>{{ item.label }}</span>
                <mat-icon>expand_more</mat-icon>
              </button>
              <mat-menu #menuRef="matMenu">
                <ng-container *ngFor="let child of item.children">
                  <ng-container *ngIf="!child.children?.length; else childHasChildren">
                    <button mat-menu-item (click)="child.externalUrl ? openExternal(child) : navigateTo(child.route)">
                      <mat-icon>{{ child.icon }}</mat-icon>
                      <span>{{ child.label }}</span>
                    </button>
                  </ng-container>
                  <ng-template #childHasChildren>
                    <button mat-menu-item [matMenuTriggerFor]="subMenuRef">
                      <mat-icon>{{ child.icon }}</mat-icon>
                      <span>{{ child.label }}</span>
                      <mat-icon>chevron_right</mat-icon>
                    </button>
                    <mat-menu #subMenuRef="matMenu">
                      <ng-container *ngFor="let sub of child.children">
                        <button mat-menu-item (click)="sub.externalUrl ? openExternal(sub) : navigateTo(sub.route)">
                          <mat-icon>{{ sub.icon }}</mat-icon>
                          <span>{{ sub.label }}</span>
                        </button>
                      </ng-container>
                    </mat-menu>
                  </ng-template>
                </ng-container>
              </mat-menu>
            </ng-template>
          </ng-container>
        </div>
      </ng-container>
      <ng-template #emptyCenter></ng-template>
    </div>

    <div class="banner-right">
      <div class="user-texts">
        <span class="user-name">Steve Stolle</span>
        <span class="user-title">b18163</span>
      </div>      
    </div>
  </div>
</div>
<mat-drawer-container class="shell" [autosize]="true">
  <mat-drawer class="nav" [class.collapsed]="!isExpanded()" mode="side" [opened]="true" [autoFocus]="false" *ngIf="!showMenuInBanner()">
    <div class="nav-header" (click)="toggle()">      
      <mat-icon>{{ isExpanded() ? 'menu_open' : 'read_more' }}</mat-icon>
      <span class="nav-title" *ngIf="isExpanded()">Menü</span>
    </div>

    <nav class="nav-content" [class.collapsed]="!isExpanded()">
      <ul class="menu">
        <ng-container *ngFor="let item of menu()">
          <li class="menu-item" [class.active]="isActive(item)" [class.ancestor-active]="isAncestorActive(item)">
            <div class="menu-row" [class.clickable]="item.children?.length" (click)="item.children?.length ? toggleNode(item) : (item.externalUrl ? openExternal(item) : null)" [routerLink]="!item.children?.length && item.route ? item.route : null">
              <mat-icon class="menu-icon">{{ item.icon }}</mat-icon>
              <span class="menu-label" *ngIf="isExpanded()">{{ item.label }}</span>
              <span class="spacer"></span>
              <mat-icon *ngIf="item.children?.length && isExpanded()">{{ item.expanded ? 'expand_less' : 'expand_more' }}</mat-icon>
            </div>

            <ul class="submenu" *ngIf="item.children?.length && item.expanded">
              <ng-container *ngFor="let child of item.children">
                <li class="menu-item" [class.active]="isActive(child)" [class.ancestor-active]="isAncestorActive(child)">
                  <div class="menu-row" [class.clickable]="child.children?.length" (click)="child.children?.length ? toggleNode(child) : (child.externalUrl ? openExternal(child) : null)" [routerLink]="!child.children?.length && child.route ? child.route : null">
                    <mat-icon class="menu-icon">{{ child.icon }}</mat-icon>
                    <span class="menu-label" *ngIf="isExpanded()">{{ child.label }}</span>
                    <span class="spacer"></span>
                    <mat-icon *ngIf="child.children?.length && isExpanded()">{{ child.expanded ? 'expand_less' : 'expand_more' }}</mat-icon>
                  </div>

                  <ul class="submenu" *ngIf="child.children?.length && child.expanded">
                    <li class="menu-item" *ngFor="let sub of child.children" [class.active]="isActive(sub)" [class.ancestor-active]="isAncestorActive(sub)">
                      <div class="menu-row" [routerLink]="sub.route || null">
                        <mat-icon class="menu-icon">{{ sub.icon }}</mat-icon>
                        <span class="menu-label" *ngIf="isExpanded()">{{ sub.label }}</span>
                      </div>
                    </li>
                  </ul>
                </li>
              </ng-container>
            </ul>
          </li>
        </ng-container>
      </ul>
    </nav>

    <div class="nav-footer">
      <button class="icon-btn" (click)="toggleMenuPlacement()" aria-label="Menü in Banner umschalten">
        <mat-icon>more_horiz</mat-icon>
      </button>
    </div>
  </mat-drawer>

  <div class="content" *ngIf="!showMenuInBanner(); else contentWithBannerMenu">
    <!-- <header class="topbar">
      <button class="icon-btn" (click)="toggle()" aria-label="Toggle sidenav">
        <mat-icon>{{ isExpanded() ? 'menu_open' : 'read_more' }}</mat-icon>
      </button>
      <h1>{{ title() }}</h1>
    </header> -->

    <section class="page">
      <h2>Beispielinhalt</h2>
      <p>
        Dies ist ein Beispielinhalt. Rechts ist der Content-Bereich, links die einklappbare Material
        Sidenav mit Icons im kompakten Zustand und Icons + Text im erweiterten Zustand.
      </p>
      <router-outlet />
    </section>
  </div>
  <ng-template #contentWithBannerMenu>
    <div class="content">
      <!-- <header class="topbar">
        <button class="icon-btn" (click)="toggle()" aria-label="Toggle sidenav">
          <mat-icon>{{ isExpanded() ? 'menu_open' : 'read_more' }}</mat-icon>
        </button>
        <h1>{{ title() }}</h1>
      </header> -->

      <section class="page">
        <h2>Beispielinhalt</h2>
        <p>
          Dies ist ein Beispielinhalt. Rechts ist der Content-Bereich, links die einklappbare Material
          Sidenav mit Icons im kompakten Zustand und Icons + Text im erweiterten Zustand.
        </p>
        <router-outlet />
      </section>
    </div>
  </ng-template>
</mat-drawer-container>

